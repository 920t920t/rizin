---
import type { Fighter } from '@lib/types';
import { safeText, winRate } from '@lib/format';
const { fighter } = Astro.props as { fighter: Fighter };
const nat = fighter.profile?.nationality?.[0] ?? null;
---
<article class="card" style="position:relative;">
  <h3 style="margin:0 0 6px 0;"><a href={`${import.meta.env.BASE_URL}fighters/${fighter.id}`}>{safeText(fighter.name)}</a></h3>
  <div class="muted" style="font-size:13px;">{safeText(fighter.kana)}</div>
  <div style="margin:8px 0;display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
    <span class="pill">階級: {safeText(fighter.weightClass)}</span>
    <span class="pill">国籍: {nat ?? '-'}</span>
  </div>
  <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:baseline;">
    <div class="muted" style="font-size:14px;">
      戦績: {fighter.record?.wins ?? '-'}勝 {fighter.record?.losses ?? '-'}敗 {fighter.record?.draws ?? '-'}分
    </div>
    <div class="pill" title="勝率（勝/勝敗）" style="font-weight:700;">勝率 {winRate(fighter.record?.wins, fighter.record?.losses, fighter.record?.draws)}</div>
  </div>
  {fighter.wikipedia?.url && (
    <a href={fighter.wikipedia.url} target="_blank" rel="noopener noreferrer" aria-label="Wikipedia" title="Wikipedia"
       style="position:absolute; right:8px; bottom:8px; width:22px; height:22px; display:inline-block; opacity:.9;">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="22" height="22" aria-hidden="true" focusable="false">
        <circle cx="16" cy="16" r="15" fill="#e5e7eb"/>
        <text x="16" y="21" text-anchor="middle" font-family="Georgia, serif" font-weight="700" font-size="16" fill="#111">W</text>
      </svg>
    </a>
  )}
</article>
